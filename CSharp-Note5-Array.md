# 数组

## 7 - 数组

### 7.1 - 相同类型的多个对象

可以使用集合和数组，对于数量固定的可以使用数组。

对于多个不同类型的对象可以使用类、结构或元组。

### 7.2 - 简单数组

数组是一种数据结构，它可以包含同一类型的多个元素。

#### 7.2.1 - 数组的声明

使用类型紧跟一对中括号来声明数组，后面跟标识符。比如，下面的代码声明了一个 `int` 类型的数组：

```cs
int[] array;
```

#### 7.2.2 - 数组的初始化

数组是引用类型，所以必须给它分配堆上的内存。应该使用 `new` 运算符，指定元素的类型和数量来初始化数组的变量：

```cs
int[] array = new int[8];
```

上面的代码中 `array` 引用了一个包含8个 `int` 类型的元素的数组，它们位于托管堆上。

> 注意：在指定了数组的大小后，如果不复制其中的所有元素就不能调整大小。而对于很大的数组来说复制数组是一场性能灾难，如果事先不知道包含多少个元素，应该使用集合。

还可以使用数组初始化器为每个元素复制，数组初始化器只能在声明数组的时候使用，不能在声明之后使用。

```cs
int[] array = new int[4] {2, 4, 6, 8};
```

如果使用了初始化器（花括号那个）来初始化数组，可以不指定数组的大小，由编译器自动计算：

```cs
int[] daysOfMonthTable = new int[] {31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};
```

当然，使用花括号可以同时声明和初始化数组：

```cs
int[] daysOfMonthTable = {31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};
```

#### 7.2.3 访问数组元素

通过索引器传递元素编号，就可以访问数组。索引器总是从0开始，`array[0]` 表示 `array` 数组的第一个元素。

如果不知道数组中元素的个数，又想遍历数组，可以在 `for` 使用 `array.Length` 属性：

```cs
for (var i = 0; i < array.Length; ++i)
{
    Console.WriteLine(array[i]);
}
```

当然，也可以使用 `foreach` 语句，但是 `foreach` 不能更改其中的元素：

```cs
foreach(var item in array)
{
    Console.WriteLine(item);
}
```

#### 7.2.4 - 使用引用类型

除了能声明预定义类型的数组，还可以声明自定义类型的数组，语法同上：

```cs
Student[] stu = new Student[60];
```

声明完后每个元素的引用都是 `null` ，因此，需要使用从0开始的索引器，可以为数组每个元素分配内存：

```cs
stu[0] = new Student()
{
    Name = "Jack",
    Class = "5",
};

stu[0] = new Student()
{
    Name = "John",
    Class = "2",
};

// ...
```

当然，也可以使用数组初始化器。

### 7.3 - 多维数组

正如前面所见的，一维数组使用一个整数来索引，而多维数组使用多个整数来索引（比如我们可以用两个整数分别索引行和列）。

在C#中声明一个二维数组可以在方括号中间加上一个逗号，比如：

```cs
int[,] matrix = 
{
    {1, 2, 3},
    {4, 5, 6},
    {7, 8, 9}
};
```

显而易见，适用于一维数组的初始化器也能用。

### 7.4 - 锯齿数组

锯齿数组的大小设置比较灵活，不像二维数组那样必须是“方方正正”的，锯齿数组中每一行都可以有不同的大小：

```cs
int[][] array = new int[3][];

array[0] = new int[4] {1, 2, 3, 4};
array[1] = new int[2] {16, 32};
array[2] = new int[1] {114514};
```

定义时，第一个方括号里写行数，第二个留空。

可以看作每个元素都是另外一个数组吧。

### 7.5 - Array 类

用方括号声明数组是C#中 `Array` 类的表示法。在后台使用 `C#` 语法，会创建一个派生自抽象基类 `Array` 的新类。这样，就可以使用 `Array` 类中的方法和属性了。

#### 7.5.1 - 创建数组

除了可以使用C#语法来创建数组实例之外，还可以使用静态方法 `Array.CreateInstance` 来创建数组。如果事先不知道元素的类型，该静态方法就非常有用，因为类型可以作为 `Type` 对象传递给 `CreateInstance` 方法。

还可以将用 `CreateInstance` 方法创建好的数组强制转换为 `int` 数组：

```cs
var array = Array.CreateInstance(typeof(int), 6);

var arrayAfterConvert = (int[])array;
```

#### 7.5.2 - 复制数组

因为数组是引用类型，所以将数组的一个变量赋值给另外一个变量，得到是引用同一个数组的变量。使用 `Clone` 方法可以复制数组：

```cs
var array1 = {1, 2};
var array2 = (int[])array1.Clone();
```

`Clone` 方法是浅复制，也就是说，如果数组的元素的引用类型，则仅复制引用而不深入复制值。

还可以使用 `Array.Copy` 方法创建浅表副本，与 `Clone` 的区别是， `Copy` 方法需要传递一个阶数仙童并且足够大的数组作为参数，而不是像 `Clone` 创建并返回一个新数组。

#### 7.5.3 - 排序

`Array` 类使用快排算法来对数组中的元素进行排序。